<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微信小程序 | 陈扬伟的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/blog/favicon.ico">
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/blog/js/MouseClickEffect.js"></script>
    <meta name="description" content="前端、算法笔记与其他干货分享（不断完善中...）">
    
    <link rel="preload" href="/blog/assets/css/0.styles.5ac611bc.css" as="style"><link rel="preload" href="/blog/assets/js/app.18c65dc5.js" as="script"><link rel="preload" href="/blog/assets/js/2.e098fada.js" as="script"><link rel="preload" href="/blog/assets/js/24.2291cb77.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.e79643c5.js"><link rel="prefetch" href="/blog/assets/js/11.4b7afe26.js"><link rel="prefetch" href="/blog/assets/js/12.0c29f934.js"><link rel="prefetch" href="/blog/assets/js/13.15a16453.js"><link rel="prefetch" href="/blog/assets/js/14.96df4f58.js"><link rel="prefetch" href="/blog/assets/js/15.09128821.js"><link rel="prefetch" href="/blog/assets/js/16.09dd63cb.js"><link rel="prefetch" href="/blog/assets/js/17.d14ee658.js"><link rel="prefetch" href="/blog/assets/js/18.98f16408.js"><link rel="prefetch" href="/blog/assets/js/19.21cfc1c8.js"><link rel="prefetch" href="/blog/assets/js/20.7731c998.js"><link rel="prefetch" href="/blog/assets/js/21.a47d9edc.js"><link rel="prefetch" href="/blog/assets/js/22.e9e2dcf8.js"><link rel="prefetch" href="/blog/assets/js/23.2d4ca6f8.js"><link rel="prefetch" href="/blog/assets/js/25.7ddd3eea.js"><link rel="prefetch" href="/blog/assets/js/26.a7775947.js"><link rel="prefetch" href="/blog/assets/js/27.9030aa1d.js"><link rel="prefetch" href="/blog/assets/js/28.fbda1538.js"><link rel="prefetch" href="/blog/assets/js/29.3927e10d.js"><link rel="prefetch" href="/blog/assets/js/3.75d96a17.js"><link rel="prefetch" href="/blog/assets/js/30.0eb31cb9.js"><link rel="prefetch" href="/blog/assets/js/31.48bbd242.js"><link rel="prefetch" href="/blog/assets/js/32.33beb443.js"><link rel="prefetch" href="/blog/assets/js/33.7e5ad22a.js"><link rel="prefetch" href="/blog/assets/js/34.74c7e612.js"><link rel="prefetch" href="/blog/assets/js/35.a91fe138.js"><link rel="prefetch" href="/blog/assets/js/4.170fa8c2.js"><link rel="prefetch" href="/blog/assets/js/5.02623ce8.js"><link rel="prefetch" href="/blog/assets/js/6.ed1d4fab.js"><link rel="prefetch" href="/blog/assets/js/7.50bce60e.js"><link rel="prefetch" href="/blog/assets/js/8.d803c2c9.js"><link rel="prefetch" href="/blog/assets/js/9.2497bbf4.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.5ac611bc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/other/logo.png" alt="陈扬伟的博客" class="logo"> <span class="site-name can-hide">陈扬伟的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/blogs/nav/" class="nav-link">
  导航
</a></div><div class="nav-item"><a href="/blog/blogs/frontend/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/blog/blogs/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blog/blogs/other/" class="nav-link">
  干货
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的" class="dropdown-title"><span class="title">我的</span> <span class="arrow down"></span></button> <button type="button" aria-label="我的" class="mobile-dropdown-title"><span class="title">我的</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/cyw0012/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_66306407?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/blogs/nav/" class="nav-link">
  导航
</a></div><div class="nav-item"><a href="/blog/blogs/frontend/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/blog/blogs/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blog/blogs/other/" class="nav-link">
  干货
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的" class="dropdown-title"><span class="title">我的</span> <span class="arrow down"></span></button> <button type="button" aria-label="我的" class="mobile-dropdown-title"><span class="title">我的</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/cyw0012/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_66306407?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/blogs/frontend/" aria-current="page" class="sidebar-link">前端介绍</a></li><li><a href="/blog/blogs/frontend/html5.html" class="sidebar-link">HTML5</a></li><li><a href="/blog/blogs/frontend/css3.html" class="sidebar-link">CSS3</a></li><li><a href="/blog/blogs/frontend/moveweb.html" class="sidebar-link">移动 web</a></li><li><a href="/blog/blogs/frontend/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/blog/blogs/frontend/webapis.html" class="sidebar-link">WebAPIs</a></li><li><a href="/blog/blogs/frontend/es6.html" class="sidebar-link">ES6</a></li><li><a href="/blog/blogs/frontend/jquery.html" class="sidebar-link">jQuery</a></li><li><a href="/blog/blogs/frontend/ajax.html" class="sidebar-link">Ajax</a></li><li><a href="/blog/blogs/frontend/nodejs.html" class="sidebar-link">NodeJs</a></li><li><a href="/blog/blogs/frontend/vue2.html" class="sidebar-link">Vue2</a></li><li><a href="/blog/blogs/frontend/vue3.html" class="sidebar-link">Vue3</a></li><li><a href="/blog/blogs/frontend/typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/blog/blogs/frontend/react.html" class="sidebar-link">React</a></li><li><a href="/blog/blogs/frontend/wechat.html" aria-current="page" class="active sidebar-link">微信小程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#一、起步" class="sidebar-link">一、起步</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_1-准备工作" class="sidebar-link">(1) 准备工作</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_2-小程序的构成" class="sidebar-link">(2) 小程序的构成</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_3-宿主环境" class="sidebar-link">(3) 宿主环境</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_4-协调工作和发布" class="sidebar-link">(4) 协调工作和发布</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#二、模板与配置" class="sidebar-link">二、模板与配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_1-模板语法" class="sidebar-link">(1) 模板语法</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_2-全局配置" class="sidebar-link">(2) 全局配置</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_3-网络请求" class="sidebar-link">(3) 网络请求</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#三、视图与逻辑" class="sidebar-link">三、视图与逻辑</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_1-页面导航" class="sidebar-link">(1) 页面导航</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_2-页面事件" class="sidebar-link">(2) 页面事件</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_3-生命周期" class="sidebar-link">(3) 生命周期</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_4-wxs-脚本" class="sidebar-link">(4) WXS 脚本</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#四、基础加强" class="sidebar-link">四、基础加强</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_1-自定义组件" class="sidebar-link">(1) 自定义组件</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_2-使用-npm-包" class="sidebar-link">(2) 使用 npm 包</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_3-全局数据共享" class="sidebar-link">(3) 全局数据共享</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#_4-分包" class="sidebar-link">(4) 分包</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/blogs/frontend/wechat.html#五、uni-app" class="sidebar-link">五、uni-app</a></li></ul></li><li><a href="/blog/blogs/frontend/demo.html" class="sidebar-link">案例分享</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="微信小程序"><a href="#微信小程序" class="header-anchor">#</a> 微信小程序</h1> <h2 id="一、起步"><a href="#一、起步" class="header-anchor">#</a> 一、起步</h2> <h3 id="_1-准备工作"><a href="#_1-准备工作" class="header-anchor">#</a> (1) 准备工作</h3> <p><a href="https://developers.weixin.qq.com/doc/" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li><p>网页与小程序的区别</p> <img src="/blog/blog_img/wechat_01.png"></li> <li><p>体验微信小程序</p> <img src="/blog/blog_img/wechat_02.png" style="width:300px;display:block;margin:0 auto;"></li> <li><p>创建第一个小程序</p></li></ol> <ul><li><p>注册小程序账号：<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>立即注册-》小程序-》填写账号信息-》点击链接激活-》填写主体信息。</p> <p>获取小程序 AppID：</p> <p><a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">登录到微信小程序的管理后台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>-》开发-》开发设置</p></li> <li><p>安装开发者工具：</p> <p>下载稳定版（<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html" target="_blank" rel="noopener noreferrer">传送门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <p>扫码登陆</p></li> <li><p>设置外观和代理：</p> <p>外观：主题浅色；测试主题浅色；字号 16；行距 12；</p> <p>网络：不使用任何代理，勾选后直连网络</p></li> <li><p>创建项目：</p> <img src="/blog/blog_img/wechat_03.png" style="width:500px;display:block;margin:0 auto;"></li> <li><p>主界面的 5 个组成部分：</p> <img src="/blog/blog_img/wechat_04.png" style="width:500px;display:block;margin:0 auto;"></li></ul> <h3 id="_2-小程序的构成"><a href="#_2-小程序的构成" class="header-anchor">#</a> (2) 小程序的构成</h3> <ul><li><p><strong>pages：所有小程序页面</strong></p> <ul><li><p>把页面以单独的文件夹存放</p> <ul><li><p>.js 文件：页面脚本文件，存放页面数据、事件处理函数</p></li> <li><p>.json 文件：页面配置文件，配置窗口外观、表现</p></li> <li><p>.wxml 文件：页面结构</p></li> <li><p>.wxss 文件：页面样式表文件</p></li></ul></li> <li><p>logs：日志文件</p></li></ul></li> <li><p>utils：工具性质的模块</p></li> <li><p><strong>app.js：小程序入口文件</strong></p></li> <li><p><strong>app.json：项目的全局配置文件</strong></p></li> <li><p>app.wxss：全局样式文件</p></li> <li><p>project.config.json：项目的配置文件</p></li> <li><p>sitemap.json：配置小程序及其页面是否允许被微信索引</p></li></ul> <br> <ol><li><p>JSON 文件类型与作用：</p> <ul><li><p>app.json（全局配置）</p> <ul><li><p>pages:用来记录当前小程序所有页面的路径</p></li> <li><p>window:全局定义小程序所有页面的背景色、文字颜色等</p></li> <li><p>style:全局定义小程序组件所使用的样式版本</p></li> <li><p>sitemapLocation:用来指明 sitemap.json 的位置</p></li></ul></li> <li><p>project.private.config.json（对小程序开发工具做的个性化配置）</p> <ul><li><p>setting 中保存了编译相关的配置</p></li> <li><p>projectname 中保存的是项目名称</p></li> <li><p>appid 中保存的是小程序的账号 D</p></li></ul></li> <li><p>sitemap.json（小程序内搜索）</p> <p>关闭页面索引提示：project.config.json 的 setting 中配置字段 checkSiteMap 为 false</p></li> <li><p>页面文件.json（窗口外观配置）</p></li></ul></li> <li><p>新建小程序页面：</p> <p>在 app.json -&gt; pages 中新增页面存放路径，可自动创建。</p> <p>修改存放路径顺序可修改首页。</p></li> <li><p>WXML：</p> <p>和 HTML 的区别：标签名称不同；属性节点不同；WXML 提供了类似于 Vue 中的模板语法。</p></li> <li><p>WXSS：</p> <p>和 CSS 的区别：新增了 rpx 尺寸单位（自动换算）；提供了全局样式和局部样式；仅支持部分 CSS 选择器（.class 和#id、element、并集选择器、后代选择器、:after 和：before 等伪类选择器）</p></li> <li><p>JS 逻辑交互：</p> <ul><li><p>app.js：程序入口文件</p></li> <li><p>页面.js：页面入口文件（Page()创建、运行页面）</p></li> <li><p>普通.js：功能模块</p></li></ul></li></ol> <h3 id="_3-宿主环境"><a href="#_3-宿主环境" class="header-anchor">#</a> (3) 宿主环境</h3> <p>程序运行所必须依赖的环境。手机微信是小程序的宿主环境。</p> <p>宿主环境包含的内容：通信模型、运行机制、组件、API。</p> <br> <ol><li><p>通信模型</p> <p>通信主体：</p> <ul><li>渲染层(WXML、WXSS)</li> <li>逻辑层（Js 脚本）</li></ul> <p>逻辑层和第三方服务器</p> <img src="/blog/blog_img/wechat_05.png"></li> <li><p>运行机制</p> <ul><li><p>小程序：下载代码包-》解析 app.json-》app.js(App())-》渲染-》启动</p></li> <li><p>页面渲染：解析.json-》加载.wxml、.wxss-》执行.js 调用 Page()-》渲染</p></li></ul></li> <li><p>组件</p></li></ol> <ul><li><p>视图容器</p> <ul><li><p>view：块级元素</p></li> <li><p>scroll-view：可滚动的视图区域</p></li> <li><p>swiper、swiper-item：轮播图容器组件、轮播图 item 组件</p> <p>swiper 常用属性：</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>默认值</th> <th>说明</th></tr></thead> <tbody><tr><td>indicator-dots</td> <td>boolean</td> <td>false</td> <td>是否显示面板指示点</td></tr> <tr><td>indicator-color</td> <td>color</td> <td>rgba(0,0,0,.3)</td> <td>指示点颜色</td></tr> <tr><td>indicator-active-color</td> <td>color</td> <td>#000000</td> <td>当前选中的指示点颜色</td></tr> <tr><td>autoplay</td> <td>boolean</td> <td>false</td> <td>是否自动切换</td></tr> <tr><td>interval</td> <td>number</td> <td>5000</td> <td>自动切换时间间隔</td></tr> <tr><td>circular</td> <td>boolean</td> <td>false</td> <td>是否采用衔接滑动</td></tr></tbody></table></li></ul></li> <li><p>基础内容</p> <ul><li>text：文本组件（selectable 属性可长按选中）</li> <li>rich-text：富文本组件（nodes 属性可将字符串渲染为 UI 结构）</li></ul></li> <li><p>其他常用组件</p> <ul><li><p>button</p> <p>type=&quot;primary&quot; 主色调按钮；type=&quot;warn&quot; 警告按钮；</p> <p>size=&quot;mini&quot; 小尺寸按钮；plain 镂空按钮</p></li> <li><p>image</p> <p>mode 属性：</p> <table><thead><tr><th>模式名称</th> <th>说明</th></tr></thead> <tbody><tr><td>scaleToFill</td> <td>（默认值）缩放模式，<strong>不保持纵横比缩放图片</strong>，使图片的宽高完全拉伸至<strong>填满 image 元素</strong></td></tr> <tr><td>aspectFit</td> <td>缩放模式，<strong>保持纵横比缩放图片，使图片的长边能完全显示出来</strong>。也就是说，可以完整地将图片显示出来</td></tr> <tr><td>aspectFill</td> <td>缩放模式，<strong>保持纵横比缩放图片，只保证图片的短边能完全显示出来</strong>。也就是说，图片通常只在水平或垂直方向是完整的，另一个方向将会发生截取</td></tr> <tr><td>widthFix</td> <td>缩放模式，<strong>宽度不变，高度自动变化</strong>，保特原图宽高比不变</td></tr> <tr><td>heightFix</td> <td>缩放模式，<strong>高度不变，宽度自动变化</strong>，保持原图宽高比不变</td></tr></tbody></table></li> <li><p>navigation</p></li></ul></li></ul> <ol start="4"><li><p>小程序-API</p> <ul><li><p>事件监听 API：wx.onWindowResize() //监听窗口变化</p></li> <li><p>同步 API：wx.setStorageSync('key', 'value') //本地存储</p></li> <li><p>异步 API：wx.request() //网络请求</p></li></ul></li></ol> <h3 id="_4-协调工作和发布"><a href="#_4-协调工作和发布" class="header-anchor">#</a> (4) 协调工作和发布</h3> <ol><li><p>权限管理需求</p></li> <li><p>项目成员组织结构：</p> <img src="/blog/blog_img/wechat_06.png"></li> <li><p>开发流程：</p> <img src="/blog/blog_img/wechat_07.png"></li> <li><p>成员管理：</p></li> <li><p>小程序版本：</p> <table><thead><tr><th>版本阶段</th> <th>说明</th></tr></thead> <tbody><tr><td>开发版本</td> <td>使用开发者工具，可将代码上传到开发版本中。开发版本只保留每人最新的一份上传的代码。 点击提交审核，可将代码提交审核。开发版本可删除，不影响线上版本和审核中版本的代码</td></tr> <tr><td>体验版本</td> <td>可以选择某个开发版本作为体验版，并且选取一份体验版</td></tr> <tr><td>审核中的版本</td> <td>只能有一份代码处于审核中。有审核结果后可以发布到线上，也可直接重新提交审核，覆盖原审核版本</td></tr> <tr><td>线上版本</td> <td>线上所有用户使用的代码版本，该版本代码在新版本代码发布后被覆盖更新</td></tr></tbody></table></li> <li><p>上传代码（开发工具）-》管理、版本管理、开发版本提交审核（后台）-》审核通过发布-》小程序推广（后台-》设置-》基本设置-》基本信息）。</p></li></ol> <p>运营数据：小程序后台（统计）、小程序数据助手</p> <h2 id="二、模板与配置"><a href="#二、模板与配置" class="header-anchor">#</a> 二、模板与配置</h2> <h3 id="_1-模板语法"><a href="#_1-模板语法" class="header-anchor">#</a> (1) 模板语法</h3> <ol><li><p>数据绑定</p> <div class="language- extra-class"><pre class="language-text"><code>js 中 data 中放数据；wxml 用 {{  }} 渲染数据。

{{  }} 可动态绑定数据、动态绑定属性、表达式运算
</code></pre></div></li> <li><p>事件绑定</p> <p>(1) 常见事件</p> <table><thead><tr><th>类型</th> <th>绑定方式</th> <th>事件描述</th></tr></thead> <tbody><tr><td>tap</td> <td>bindtap 或 bind:tap</td> <td>手指触授后马上离开，类似于 HTML 中的 click 事件</td></tr> <tr><td>input</td> <td>bindinput 或 bind:input</td> <td>文本框的输入事件</td></tr> <tr><td>change</td> <td>bindchange 或 bind:change</td> <td>状态改变时触发</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 修改值</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 要修改的变量（对象属性为'obj.key'）: 新值（旧值为 this.data.变量）</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>(2) 事件对象属性列表（event）</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>type</td> <td>String</td> <td>事件类型</td></tr> <tr><td>timeStamp</td> <td>Integer</td> <td>页面打开到触发事件所经过的毫秒数</td></tr> <tr><td>target</td> <td>Object</td> <td>触发事件的组件的一些属性值集合</td></tr> <tr><td>currentTarget</td> <td>Object</td> <td>当前组件的一些属性值集合</td></tr> <tr><td>detail</td> <td>Object</td> <td>额外的信息</td></tr> <tr><td>touches</td> <td>Array</td> <td>触摸事件，当前停留在屏幕中的触摸点信息的数组</td></tr> <tr><td>changedTouches</td> <td>Array</td> <td>触摸事件，当前变化的触摸点信息的数组</td></tr></tbody></table> <p>e.currentTarget 指向的是当前触发事件的组件</p> <p>(3) 事件传参：</p> <p>不能直接传参，通过 data-* 自定义属性来传参，事件处理函数通过 e.target.dataset.XXX 来获取。</p> <p>(4) bindinput 事件通过 e.detail.value 获取输入框的值</p></li> <li><p>条件渲染</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- wx:if、wx:elif、wx:else  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{  }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 动态添加 display:none; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{  }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 频繁切换用 hidden --&gt;</span>
</code></pre></div><p><code>&lt;block&gt;</code> 起包裹作用，不渲染，一次性控制多个组件显示与隐藏。</p></li> <li><p>列表渲染</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- wx:for-index=&quot;idx&quot;指定索引名；wx:for-item=&quot;itm&quot;指定item名字 --&gt;</span>
<span class="token comment">&lt;!-- wx:key=&quot;id&quot; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{array}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    索引：{{index}}，item项：{item}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>WXSS 样式</p> <img src="/blog/blog_img/wechat_08.png" style="width:350px;display:block;margin:0 auto;"> <p>(1) rpx（屏适配）</p> <p>在设备上等分成了 750 rpx。建议 iphone6 作为标准视觉稿（1px=2rpx）。</p> <p>(2) 样式导入（@import &quot;&quot;）</p> <p>(3) 全局样式和局部样式</p></li></ol> <h3 id="_2-全局配置"><a href="#_2-全局配置" class="header-anchor">#</a> (2) 全局配置</h3> <p>在 app.json</p> <ol><li><p>小程序组成部分</p> <img src="/blog/blog_img/wechat_09.png"></li> <li><p>常用配置项</p> <table><thead><tr><th>属性名</th> <th>类型</th> <th>默认值</th> <th>说明</th></tr></thead> <tbody><tr><td>navigationBarTitleText</td> <td>String</td> <td>字符串</td> <td>导航栏标题文字内容</td></tr> <tr><td>navigationBarBackgroundColor</td> <td>HexColor</td> <td>#000000</td> <td>导航栏背景颜色，如#000000</td></tr> <tr><td>navigationBarTextStyle</td> <td>String</td> <td>white</td> <td>导航栏标题颜色，仅支持 black/white</td></tr> <tr><td>backgroundColor</td> <td>HexColor</td> <td>#ffffff</td> <td>窗口的背景色</td></tr> <tr><td>backgroundTextStyle</td> <td>String</td> <td>dark</td> <td>下拉 loading 的样式，仅支持 dark/ight</td></tr> <tr><td>enablePullDownRefresh</td> <td>Boolean</td> <td>false</td> <td>是否全局开启下拉刷新</td></tr> <tr><td>onReachBottomDistance</td> <td>Number</td> <td>50</td> <td>页面上拉触底事件触发时距页面底部距离，单位为 PX</td></tr></tbody></table></li> <li><p>tabBar（和”windows&quot;平级）</p> <p>顶部 tabBar、底部 tabBar；最少 2 个、最多 5 个 tab 页签；顶部 tabBar 不显示 icon。</p> <p>tabBar 配置项：</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>必填</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>position</td> <td>String</td> <td>否</td> <td>bottom</td> <td>tabBar 的位置，仅支持 bottom/top</td></tr> <tr><td>borderStyle</td> <td>String</td> <td>否</td> <td>black</td> <td>tabBar 上边框的颜色，仅支持 black/white</td></tr> <tr><td>color</td> <td>HexColor</td> <td>否</td> <td></td> <td>tab 上文字的默认（未选中）颜色</td></tr> <tr><td>selectedColor</td> <td>HexColor</td> <td>否</td> <td></td> <td>tab 上的文字选中时的颜色</td></tr> <tr><td>backgroundColor</td> <td>HexColor</td> <td>否</td> <td></td> <td>tabBar 的背景色</td></tr> <tr><td>list</td> <td>Array</td> <td>是</td> <td></td> <td>tab 页签的列表，最少 2 个、最多 5 个 tab</td></tr></tbody></table> <p>每个 tab 页签配置：</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>必填</th> <th>描述</th></tr></thead> <tbody><tr><td>pagePath</td> <td>String</td> <td>是</td> <td>页面路径，页面必须在 pages 中预先定义</td></tr> <tr><td>text</td> <td>String</td> <td>是</td> <td>tab 上显示的文字</td></tr> <tr><td>iconPath</td> <td>String</td> <td>否</td> <td>未选中时的图标路径；当 postion 为 top 时，不显示 icon</td></tr> <tr><td>selectedIconPath</td> <td>String</td> <td>否</td> <td>选中时的图标路径；当 postion 为 top 时，不显示 icon</td></tr></tbody></table></li></ol> <h3 id="_3-网络请求"><a href="#_3-网络请求" class="header-anchor">#</a> (3) 网络请求</h3> <p>只能请求 HTTPS 类型接口；接口的域名添加到信任列表中（详情-》项目配置-》查看合法域名）。</p> <p>添加域名到信任列表：小程序管理后台-》开发-》开发设置-》服务器域名-》修改 request 合法域名。</p> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>注意：</p> <p>域名只支持 https 协议</p> <p>域名不能使用 IP 地址或 localhost</p> <p>域名必须经过 ICP 备案</p> <p>服务器域名一个月内最多可申请 5 次修改</p></div> <ol><li><p>GET 请求</p> <div class="language-js extra-class"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://www.escook.cn/api/get'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zs'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 网络请求结束的回调函数</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>POST 请求</p> <div class="language-js extra-class"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://www.escook.cn/api/post'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zs'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <p>在 onLoad 事件中调用请求函数（this.XXX）。</p> <p>跳过 request 合法域名校验：详情-》本地设置-》不校验 XXX（仅在开发和调试阶段使用）。</p> <p>小程序不存在跨域问题；小程序请求叫”发起网络数据请求“。</p> <h2 id="三、视图与逻辑"><a href="#三、视图与逻辑" class="header-anchor">#</a> 三、视图与逻辑</h2> <h3 id="_1-页面导航"><a href="#_1-页面导航" class="header-anchor">#</a> (1) 页面导航</h3> <ol><li><p>声明式导航</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- url是'/'开头 --&gt;</span>
<span class="token comment">&lt;!-- 跳转到Tab页面 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>switchTab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 跳转到非Tab页面（open-type可省略） --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 后退导航（delta为返回的层级，默认为1） --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>navigator</span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigateBack<span class="token punctuation">&quot;</span></span> <span class="token attr-name">delta</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>navigator</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>编程式导航</p> <ul><li>跳转到 tabBar：wx.switchTab(obj)</li></ul> <table><thead><tr><th>属性</th> <th>类型</th> <th>是否必选</th> <th>说明</th></tr></thead> <tbody><tr><td>url</td> <td>string</td> <td>是</td> <td>需要跳转的 tabBar 页面的路径，路径后不能带参数</td></tr> <tr><td>success</td> <td>function</td> <td>否</td> <td>接口调用成功的回调函数</td></tr> <tr><td>fail</td> <td>function</td> <td>否</td> <td>接口调用失败的回调函数</td></tr> <tr><td>complete</td> <td>function</td> <td>否</td> <td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table> <ul><li><p>跳转到非 tabBar：wx.navigateTo(obj) (obj 属性和上面的一样)</p></li> <li><p>后退导航：wx.navigateBack(obj)</p></li></ul> <table><thead><tr><th>属性</th> <th>类型</th> <th>是否必选</th> <th>说明</th></tr></thead> <tbody><tr><td>delta</td> <td>number</td> <td>否</td> <td>（默认值为 1）返回的页面数，如果 delta 大于现有页面数，则返回到首页</td></tr> <tr><td>success</td> <td>function</td> <td>否</td> <td>接口调用成功的回调函数</td></tr> <tr><td>fail</td> <td>function</td> <td>否</td> <td>接口调用失败的回调函数</td></tr> <tr><td>complete</td> <td>function</td> <td>否</td> <td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table></li> <li><p>导航传参：<code>url=&quot;/pages/info/info?name=zs&amp;age=19&quot;</code></p> <p>接收参数：onLoad(options)，options 为接收到的参数</p></li></ol> <h3 id="_2-页面事件"><a href="#_2-页面事件" class="header-anchor">#</a> (2) 页面事件</h3> <ol><li><p>下拉刷新</p> <ul><li><p>启用下拉刷新</p></li> <li><p>事件处理（onPullDownRefresh）</p></li> <li><p>事件处理完关闭下拉刷新（wx.stopPullDownRefresh()）</p></li></ul></li> <li><p>上拉触底</p> <ul><li><p>事件处理（onReachBottom）</p></li> <li><p>loading 效果显示与关闭（wx.showLoading({})、wx.hideLoading({})）</p></li> <li><p>节流</p></li> <li><p>数据加载完成（wx.showToast({})）</p></li></ul></li></ol> <p>自定义编译模式：普通编译-》添加编译模式</p> <h3 id="_3-生命周期"><a href="#_3-生命周期" class="header-anchor">#</a> (3) 生命周期</h3> <ol><li><p>应用生命周期（app.js）</p> <ul><li><p>onLaunch: function(options) {} ：小程序初始化完成（全局只触发一次）</p></li> <li><p>onShow: function(options) {} ：小程序启动，或者后台进入前台</p></li> <li><p>onHide: function(options) {} ：前台进入后台</p></li></ul></li> <li><p>页面生命周期</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//页面的 .js文件</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//监听页面加载，一个页面只调用1次</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//监听页面显示</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//监听页面初次渲染完成，一个页面只调用1次</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//监听页面隐藏</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//监听页面卸载，一个页面只调用1次</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="_4-wxs-脚本"><a href="#_4-wxs-脚本" class="header-anchor">#</a> (4) WXS 脚本</h3> <p>wxml 无法调用页面的.js 中定义的函数，wxs 典型应用场景是<strong>过滤器</strong>。</p> <p>① WXS 有自己的数据类型：</p> <ul><li>number 数值类型、string 字符串类型、boolean 布尔类型、object 对象类型</li> <li>function 函数类型、array 数组类型、date 日期类型、regexp 正则</li></ul> <p>② WXS 不支持类似于 ES6 及以上的语法形式：</p> <ul><li>不支持：let、const、解构赋值、展开运算符、箭头函数、对象属性简写、etc.…</li> <li>支持：var 定义变量、普通 function 函数等类似于 ES5 的语法</li></ul> <p>③ Wxs 遵循 CommonJS 规范：</p> <ul><li>module 对象</li> <li>require()函数</li> <li>nodule.exports 对象</li></ul> <ol><li><p>内嵌 wxs 脚本</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{m1.toUpper(username)}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 必须要有 module 属性 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>m1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    module.exports.toUpper = function(str){
    	return str.toUpperCase()
    }
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>外联 wxs 脚本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// tools.wxs</span>
<span class="token keyword">function</span> <span class="token function">toLower</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 不可简写</span>
  <span class="token literal-property property">toLower</span><span class="token operator">:</span> toLower<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 使用 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{m2.toLower(uername)}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../utils/tools.wxs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>m2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ol> <p>注意：不能作为组件的事件回调函数使用；不能调用 js 中的函数、API 函数；在 IOS 性能上比 js 快很多，但在安卓上差异不大。</p> <h2 id="四、基础加强"><a href="#四、基础加强" class="header-anchor">#</a> 四、基础加强</h2> <h3 id="_1-自定义组件"><a href="#_1-自定义组件" class="header-anchor">#</a> (1) 自定义组件</h3> <ol><li><p>创建组件：创建 components-》创建存放文件夹-》新建 Conponent</p></li> <li><p>引用（局部引用、全局引用）</p> <p>在 .json 文件<code>&quot;usingComponents&quot;:{ &quot;my-test1&quot;: &quot;/components/test1/test1&quot; }</code></p> <p>组件与页面的区别：组件的.json 文件需要声明<code>&quot;component&quot;: true</code>；组件的.js 文件调用的是 Component()函数；组件的事件处理函数要定义到 methods 节点。</p></li> <li><p>样式</p> <ul><li><p>组件样式隔离（独立不影响）</p> <p>注意：app.wxss 样式不影响组件；<strong>只有类名选择器会有样式隔离效果</strong>。</p></li> <li><p>修改样式隔离选项：在自定义组件的.js 文件 Component 中添加 options 节点，然后设置选项 styleIsolation</p> <table><thead><tr><th>可选值</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>isolated</td> <td>是</td> <td>表示启用样式隔离，在自定义组件内外，使用 class 指定的样式将不会相互影响</td></tr> <tr><td>apply-shared</td> <td>否</td> <td>表示页面 WXSS 样式将影响到自定义组件，但自定义组件 WXS 中指定的样式不会影响页面</td></tr> <tr><td>shared</td> <td>否</td> <td>表示页面 WXSS 样式将影响到自定义组件，自定义组件 WXS 中指定的样式也会影响页面和其他设置了 apply-shared 或 shared 的自定义组件</td></tr></tbody></table></li></ul></li> <li><p>数据、方法、属性</p> <ul><li><p>data</p></li> <li><p>methods</p></li> <li><p>properties（传参，可读可写）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// max: Number,</span>
    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">10</span>	<span class="token comment">// 默认值为 10</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>my<span class="token operator">-</span>test1 max<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>test1<span class="token operator">&gt;</span>
</code></pre></div></li></ul> <p>通过 setData({}) 修改值，与 data 本质没有区别</p></li> <li><p>数据监听器</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">observers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听简单数据类型</span>
    <span class="token string-property property">&quot;字段A, 字段B&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">字段<span class="token constant">A</span>的新值<span class="token punctuation">,</span> 字段<span class="token constant">B</span>的新值</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 监听对象属性的变化(A赋值、B赋值、对象赋值)</span>
    <span class="token string-property property">&quot;对象.属性A, 对象.属性B&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">属性<span class="token constant">A</span>的新值<span class="token punctuation">,</span> 属性<span class="token constant">B</span>的新值</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 监听对象所有属性变化</span>
    <span class="token string-property property">&quot;对象.**&quot;</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>纯数据字段：不用于渲染的 data 字段，有助于提升页面更新的性能。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 指定纯数据对象(以下划线开头)</span>
<span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pureDataPattern</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^_</span><span class="token regex-delimiter">/</span></span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>组件的生命周期：<strong>lifetimes 节点下声明生命周期函数。</strong></p> <table><thead><tr><th>生命周期函数</th> <th>参数</th> <th>描述说明</th></tr></thead> <tbody><tr><td><strong>created</strong></td> <td>无</td> <td>在组件实例刚刚被创建时执行</td></tr> <tr><td><strong>attached</strong></td> <td>无</td> <td>在组件实例进入页面节点树时执行（发送网络请求）</td></tr> <tr><td>ready</td> <td>无</td> <td>在组件在视图层布局完成后执行</td></tr> <tr><td>moved</td> <td>无</td> <td>在组件实例被移动到节点树另一个位置时执行</td></tr> <tr><td><strong>detached</strong></td> <td>无</td> <td>在组件实例被从页面节点树移除时执行</td></tr> <tr><td>error</td> <td>Object Error</td> <td>每当组件方法抛出错误时执行</td></tr></tbody></table> <p>组件所在页面的生命周期：<strong>pageLifetimes 节点下声明。</strong></p> <table><thead><tr><th>生命周期函数</th> <th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>show</td> <td>无</td> <td>组件所在的页面被展示时执行</td></tr> <tr><td>hide</td> <td>无</td> <td>组件所在的页面被隐藏时执行</td></tr> <tr><td>resize</td> <td>Object Size</td> <td>组件所在的页面尺寸变化时执行</td></tr></tbody></table></li> <li><p>插槽：</p> <ul><li><p>单个插槽：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
    组件的内部结构:
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 使用组件： --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-component1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>我是XXX<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-component1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>多个插槽：在 options 节点启用配置 <code>multipleSlots: true</code></p> <p>指定名称，按名称进行使用插槽。</p></li></ul></li> <li><p>父子组件之间的通信</p> <ul><li><p>属性绑定：父-》子，只能传递普通数据类型的数据。</p></li> <li><p>事件绑定：子-》父，可以传递任何类型数据。</p> <p>接收函数(父组件)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">syncCount</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>自定义事件(父组件)</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-component</span> <span class="token attr-name"><span class="token namespace">bind:</span>sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{syncCount}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-component</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>触发自定义事件(子组件)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">'sync'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token constant">XXX</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>获取组件实例：<code>this.selectComponent('id、class选择器')</code>，父组件访问子组件任意数据、方法（可修改子组件数据、通过原型调用自定义事件）</p></li></ul></li> <li><p>behaviors（实现组件间代码共享）</p> <p>每个可以包含一组属性、数据、生命周期函数、方法，behaviors 可以引用其他的 behaviors。</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token function">Behavios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>，
    <span class="token literal-property property">mothods</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 导入并使用</span>
<span class="token keyword">const</span> myBeh <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token comment">// 在 Component 中添加节点（myBeh会全部挂载到this上）</span>
<span class="token literal-property property">behaviors</span><span class="token operator">:</span> <span class="token punctuation">[</span>myBeh<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>behavior 中可用节点</p> <table><thead><tr><th>可用的节点</th> <th>类型</th> <th>是否必填</th> <th>描述</th></tr></thead> <tbody><tr><td><strong>properties</strong></td> <td>Object Map</td> <td>否</td> <td>与组件属性相关的内容，包括类型、默认值、必选项等</td></tr> <tr><td><strong>data</strong></td> <td>Object</td> <td>否</td> <td>组件内部数据</td></tr> <tr><td><strong>methods</strong></td> <td>Object</td> <td>否</td> <td>自定义组件的方法</td></tr> <tr><td><strong>behaviors</strong></td> <td>String Array</td> <td>否</td> <td>引入其它的 behavior</td></tr> <tr><td>created</td> <td>Function</td> <td>否</td> <td>组件生命周期函数，在组件实例刚刚被创建时执行</td></tr> <tr><td>attached</td> <td>Function</td> <td>否</td> <td>组件生命周期函数，在组件实例进入页面节点树时执行</td></tr> <tr><td>ready</td> <td>Function</td> <td>否</td> <td>组件生命周期函数，在组件在视图层布局完成后执行</td></tr> <tr><td>moved</td> <td>Function</td> <td>否</td> <td>组件生命周期函数，在组件实例被移动到节点树另一个位置时执行</td></tr> <tr><td>detached</td> <td>Function</td> <td>否</td> <td>组件生命周期函数，在组件实例被从页面节点树移除时执行</td></tr></tbody></table> <p>同名字段的覆盖和组合规则：<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/behaviors.html" target="_blank" rel="noopener noreferrer">网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ol> <h3 id="_2-使用-npm-包"><a href="#_2-使用-npm-包" class="header-anchor">#</a> (2) 使用 npm 包</h3> <p><em>限制：不支持依赖于 Node.js 内置库、浏览器内置对象、C++插件包。</em></p> <p><strong>每次安装包时，需要先删除 miniprogram_npm 文件夹，然后重新构建。</strong></p> <p>Vant Weapp（小程序 UI 组件库，MIT 开源许可协议）：<a href="https://youzan.github.io/vant-weapp" target="_blank" rel="noopener noreferrer">网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>打开终端-》npm init -y -》npm i @vant/weapp -S --production</p> <ol><li><p>定制全局主题样式（<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSs_custom_properties" target="_blank" rel="noopener noreferrer">传送门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <p>在 app.wxss 的 page 节点写入 CSS 变量，然后可全局使用。（var 可通过逗号后添加默认值）</p></li> <li><p>API Promise 化（避免回调地狱）</p> <p>安装：npm i -save miniprogram-api-promise</p> <p>引用（在 app.js）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> promisifyAll <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'miniprogram-api-promise'</span>
<span class="token comment">// 实现异步 API Promise 化</span>
<span class="token keyword">const</span> wxp <span class="token operator">=</span> <span class="token punctuation">(</span>wx<span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">promisifyAll</span><span class="token punctuation">(</span>wx<span class="token punctuation">,</span> wxp<span class="token punctuation">)</span>
</code></pre></div><p>使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//页面的，wxml结构</span>
<span class="token operator">&lt;</span>van<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span>bindtap<span class="token operator">=</span><span class="token string">&quot;getInfo&quot;</span><span class="token operator">&gt;</span>vant组件<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>button<span class="token operator">&gt;</span>

<span class="token comment">//在页面的.js文件中，定义对应的tap事件处理函数</span>
<span class="token keyword">async</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span>res <span class="token punctuation">}</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span>p<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	  <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
	  <span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">'https://www.escook.cn/api/get'</span><span class="token punctuation">,</span>
	  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'zs'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">20</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>全局数据共享</p> <ul><li><p>mobx-miniprogram 创建 Store 实例对象</p></li> <li><p>mobx-miniprogram-bindings 把 Store 中的共享数据或方法，绑定到组件或页面中使用。</p></li></ul> <p>安装：npm i --save mobx-miniprogram@4.13.2 mobx-miniprogram-bindings@1.2.1</p> <p>创建 store：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建store文件夹和文件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobox-miniprogram'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 数据字段</span>
    <span class="token literal-property property">numA</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">numB</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token comment">// 计算属性（只读）</span>
    <span class="token keyword">get</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numB
	<span class="token punctuation">}</span>
    <span class="token comment">// 修改 store 数据</span>
    <span class="token literal-property property">updateNum1</span><span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+=</span> step
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>页面使用 store：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStoreBindings <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">''</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 将 store 数据绑定到this</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings <span class="token operator">=</span> <span class="token function">createStoreBindings</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">,</span>
      <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'numA'</span><span class="token punctuation">,</span> <span class="token string">'numB'</span><span class="token punctuation">,</span> <span class="token string">'sum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'updateNum1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings<span class="token punctuation">.</span><span class="token function">destroyStoreBindings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 使用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateNum1</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span>
</code></pre></div><p>组件使用 store：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> storeBindingsBehavior <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../store/store'</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">behaviors</span><span class="token operator">:</span> <span class="token punctuation">[</span>storeBindingsBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">storeBindings</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">,</span>
    <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'numA'</span><span class="token punctuation">,</span> <span class="token string">'numB'</span><span class="token punctuation">,</span> <span class="token string">'sum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">updateNum2</span><span class="token operator">:</span> <span class="token string">'updateNum2'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="_3-全局数据共享"><a href="#_3-全局数据共享" class="header-anchor">#</a> (3) 全局数据共享</h3> <ul><li><p>mobx-miniprogram 创建 Store 实例对象</p></li> <li><p>mobx-miniprogram-bindings 把 Store 中的共享数据或方法，绑定到组件或页面中使用。</p></li></ul> <ol><li><p>安装：npm i --save mobx-miniprogram@4.13.2 mobx-miniprogram-bindings@1.2.1</p></li> <li><p>创建 store：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建store文件夹和文件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobox-miniprogram'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 数据字段</span>
    <span class="token literal-property property">numA</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">numB</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token comment">// 计算属性（只读）</span>
    <span class="token keyword">get</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>numB
	<span class="token punctuation">}</span>
    <span class="token comment">// 修改 store 数据</span>
    <span class="token literal-property property">updateNum1</span><span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>numA <span class="token operator">+=</span> step
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>页面使用 store：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStoreBindings <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">''</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 将 store 数据绑定到this</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings <span class="token operator">=</span> <span class="token function">createStoreBindings</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">,</span>
      <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'numA'</span><span class="token punctuation">,</span> <span class="token string">'numB'</span><span class="token punctuation">,</span> <span class="token string">'sum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'updateNum1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storeBindings<span class="token punctuation">.</span><span class="token function">destroyStoreBindings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 使用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateNum1</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>组件使用 store：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> storeBindingsBehavior <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'mobx-miniprogram-bindings'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../store/store'</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">behaviors</span><span class="token operator">:</span> <span class="token punctuation">[</span>storeBindingsBehavior<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">storeBindings</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">,</span>
    <span class="token literal-property property">fields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'numA'</span><span class="token punctuation">,</span> <span class="token string">'numB'</span><span class="token punctuation">,</span> <span class="token string">'sum'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">updateNum2</span><span class="token operator">:</span> <span class="token string">'updateNum2'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="_4-分包"><a href="#_4-分包" class="header-anchor">#</a> (4) 分包</h3> <ol><li><p>按照需求划分不同的子包，按需加载；好处：优化小程序首次启动的下载时间；在多团队共同开发时可以更好的解耦协作。</p> <img src="/blog/blog_img/wechat_10.png"> <p>加载机制：下载主包-》进入某个分包页面，下载分包</p> <p>限制（详情-&gt;基本信息可查看）：总大小不能超过 16M；单个分包/主包不能超过 2M。</p></li> <li><p>配置方法：</p> <img src="/blog/blog_img/wechat_11.png"> <p>引用原则：主包无法引用分包内部的私有资源；分包之间不能相互引用私有资源；<strong>分包可以引用主包内的私有资源</strong>。</p></li> <li><p>独立分包</p> <p>本质也是分包，<strong>可以独立于主包和其他分包而单独运行</strong>。（一个小程序可有多个独立分包）</p> <p>在 app.json 配置中对应节点添加：&quot;independent&quot;: true</p> <p>注：独立分包不能引用主包的公共资源。</p></li> <li><p>分包预下载</p> <p>进入某个页面时，框架预下载分包。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// app.json</span>
<span class="token property">&quot;preloadRule&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;页面路径&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 指定在什么网络模式下进行预下载（all 不限；wifi）</span>
        <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span>
        <span class="token comment">// 指定预下载哪些包</span>
        <span class="token property">&quot;packages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;pkgA&quot;</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>限制：共同的预下载大小限制额 2M。</p></li></ol> <p>自定义 tabBar（ <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html" target="_blank" rel="noopener noreferrer">传送门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ）</p> <h2 id="五、uni-app"><a href="#五、uni-app" class="header-anchor">#</a> 五、uni-app</h2> <p>uni-app（ <a href="https://uniapp.dcloud.net.cn/" target="_blank" rel="noopener noreferrer">网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ）：跨平台框架。</p> <p>未完待续...</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/blogs/frontend/react.html" class="prev">
        React
      </a></span> <span class="next"><a href="/blog/blogs/frontend/demo.html">
        案例分享
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 陈扬伟的博客
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="http://music.163.com/song/media/outer/url?id=2049512697.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="right:10px;bottom:275px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="http://p1.music.126.net/TmOHxaGnFNlwNX8aPz66oA==/109951168638913915.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="right:10px;bottom:275px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(http://p1.music.126.net/TmOHxaGnFNlwNX8aPz66oA==/109951168638913915.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>向云端</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>小霞</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><div></div></div></div>
    <script src="/blog/assets/js/app.18c65dc5.js" defer></script><script src="/blog/assets/js/2.e098fada.js" defer></script><script src="/blog/assets/js/24.2291cb77.js" defer></script>
  </body>
</html>
