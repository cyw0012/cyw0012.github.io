<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue3 | 陈扬伟的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/favicon.ico">
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/js/MouseClickEffect.js"></script>
    <meta name="description" content="前端、算法笔记与其他干货分享（不断完善中...）">
    
    <link rel="preload" href="/assets/css/0.styles.ad38839b.css" as="style"><link rel="preload" href="/assets/js/app.e7a0482f.js" as="script"><link rel="preload" href="/assets/js/2.e098fada.js" as="script"><link rel="preload" href="/assets/js/21.dcf8b3f5.js" as="script"><link rel="prefetch" href="/assets/js/10.e5780fb7.js"><link rel="prefetch" href="/assets/js/11.4b7afe26.js"><link rel="prefetch" href="/assets/js/12.1902461d.js"><link rel="prefetch" href="/assets/js/13.94c29154.js"><link rel="prefetch" href="/assets/js/14.1cba2745.js"><link rel="prefetch" href="/assets/js/15.ba8fbcb2.js"><link rel="prefetch" href="/assets/js/16.f11c8457.js"><link rel="prefetch" href="/assets/js/17.df145544.js"><link rel="prefetch" href="/assets/js/18.4de16636.js"><link rel="prefetch" href="/assets/js/19.30a6efab.js"><link rel="prefetch" href="/assets/js/20.c992746d.js"><link rel="prefetch" href="/assets/js/22.92defdba.js"><link rel="prefetch" href="/assets/js/23.cff3e9a1.js"><link rel="prefetch" href="/assets/js/24.9fed4cbb.js"><link rel="prefetch" href="/assets/js/25.f768a83d.js"><link rel="prefetch" href="/assets/js/26.3072c51f.js"><link rel="prefetch" href="/assets/js/27.8833c625.js"><link rel="prefetch" href="/assets/js/28.a889b2f4.js"><link rel="prefetch" href="/assets/js/29.a6073ea7.js"><link rel="prefetch" href="/assets/js/3.5c626f87.js"><link rel="prefetch" href="/assets/js/30.65a67b6f.js"><link rel="prefetch" href="/assets/js/31.fe93f2b9.js"><link rel="prefetch" href="/assets/js/32.834ec01b.js"><link rel="prefetch" href="/assets/js/33.71f497dc.js"><link rel="prefetch" href="/assets/js/34.98f43b79.js"><link rel="prefetch" href="/assets/js/4.170fa8c2.js"><link rel="prefetch" href="/assets/js/5.02623ce8.js"><link rel="prefetch" href="/assets/js/6.ed1d4fab.js"><link rel="prefetch" href="/assets/js/7.50bce60e.js"><link rel="prefetch" href="/assets/js/8.d803c2c9.js"><link rel="prefetch" href="/assets/js/9.38f13918.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ad38839b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/other/logo.png" alt="陈扬伟的博客" class="logo"> <span class="site-name can-hide">陈扬伟的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blogs/nav/" class="nav-link">
  导航
</a></div><div class="nav-item"><a href="/blogs/frontend/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/blogs/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blogs/other/" class="nav-link">
  干货
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的" class="dropdown-title"><span class="title">我的</span> <span class="arrow down"></span></button> <button type="button" aria-label="我的" class="mobile-dropdown-title"><span class="title">我的</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/cyw0012/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_66306407?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blogs/nav/" class="nav-link">
  导航
</a></div><div class="nav-item"><a href="/blogs/frontend/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/blogs/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blogs/other/" class="nav-link">
  干货
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的" class="dropdown-title"><span class="title">我的</span> <span class="arrow down"></span></button> <button type="button" aria-label="我的" class="mobile-dropdown-title"><span class="title">我的</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/cyw0012/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/weixin_66306407?type=blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blogs/frontend/" aria-current="page" class="sidebar-link">前端目录</a></li><li><a href="/blogs/frontend/html5.html" class="sidebar-link">HTML5</a></li><li><a href="/blogs/frontend/css3.html" class="sidebar-link">CSS3</a></li><li><a href="/blogs/frontend/moveweb.html" class="sidebar-link">移动 web</a></li><li><a href="/blogs/frontend/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/blogs/frontend/webapis.html" class="sidebar-link">WebAPIs</a></li><li><a href="/blogs/frontend/es6.html" class="sidebar-link">ES6</a></li><li><a href="/blogs/frontend/jquery.html" class="sidebar-link">jQuery</a></li><li><a href="/blogs/frontend/ajax.html" class="sidebar-link">Ajax</a></li><li><a href="/blogs/frontend/nodejs.html" class="sidebar-link">NodeJs</a></li><li><a href="/blogs/frontend/vue2.html" class="sidebar-link">Vue2</a></li><li><a href="/blogs/frontend/vue3.html" aria-current="page" class="active sidebar-link">Vue3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#一、es6-模块化与异步化" class="sidebar-link">一、ES6 模块化与异步化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_1-es6-模块化的引入" class="sidebar-link">(1) ES6 模块化的引入</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_2-体验-es6-模块化" class="sidebar-link">(2) 体验 ES6 模块化</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_3-promise" class="sidebar-link">(3) Promise</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_4-async-awit" class="sidebar-link">(4) async / awit</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_5-执行顺序" class="sidebar-link">(5) 执行顺序</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_6-api-接口" class="sidebar-link">(6) API 接口</a></li></ul></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#二、vue3-基础入门" class="sidebar-link">二、Vue3 基础入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_1-引入" class="sidebar-link">(1) 引入</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_2-vite" class="sidebar-link">(2) vite</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_3-与-vue2-的不同点" class="sidebar-link">(3) 与 vue2 的不同点</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_4-组件通信" class="sidebar-link">(4) 组件通信</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_5-axios-与-自定义指令" class="sidebar-link">(5) axios 与 自定义指令</a></li></ul></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#三、路由" class="sidebar-link">三、路由</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#四、vue3-加强" class="sidebar-link">四、Vue3 加强</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_1-vue-cli" class="sidebar-link">(1) vue-cli</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_2-组件库" class="sidebar-link">(2) 组件库</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_3-axios-拦截器" class="sidebar-link">(3) axios 拦截器</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_4-proxy-跨域代理" class="sidebar-link">(4) proxy 跨域代理</a></li></ul></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#五、补充" class="sidebar-link">五、补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_1-打包配置" class="sidebar-link">(1) 打包配置</a></li><li class="sidebar-sub-header"><a href="/blogs/frontend/vue3.html#_2-其他" class="sidebar-link">(2) 其他</a></li></ul></li></ul></li><li><a href="/blogs/frontend/react.html" class="sidebar-link">React</a></li><li><a href="/blogs/frontend/wechat.html" class="sidebar-link">微信小程序</a></li><li><a href="/blogs/frontend/demo.html" class="sidebar-link">案例分享</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue3"><a href="#vue3" class="header-anchor">#</a> Vue3</h1> <h2 id="一、es6-模块化与异步化"><a href="#一、es6-模块化与异步化" class="header-anchor">#</a> 一、ES6 模块化与异步化</h2> <h3 id="_1-es6-模块化的引入"><a href="#_1-es6-模块化的引入" class="header-anchor">#</a> (1) ES6 模块化的引入</h3> <ol><li><p>在 ES6 模块化规范诞生之前，JavaScript 社区已经尝试并提出了 AMD、CMD、CommonJS 等模块化规范。
但是，这些由社区提出的模块化标准，还是存在一定的差异性与局限性、并不是浏览器与服务器通用的模块化标准，例如：</p> <ul><li><p>AMD 和 CMD 适用于浏览器端的 Javascript 模块化</p></li> <li><p>CommonJS 适用于服务器端的 Javascript 模块化</p></li></ul></li> <li><p>ES6 模块化规范是浏览器端和服务器端的通用模块化规范，给开发者减少学习难度和开发成本。</p></li> <li><p>ES6 模块化规范中定义：</p> <ul><li><p>每个 jS 文件都是一个独立的模块</p></li> <li><p>导入其它模块成员使用 import 关键字</p></li> <li><p>向外共享模块成员使用 export 关键字</p></li></ul></li></ol> <h3 id="_2-体验-es6-模块化"><a href="#_2-体验-es6-模块化" class="header-anchor">#</a> (2) 体验 ES6 模块化</h3> <p>Node.js 要高于 v14.15.1</p> <ol><li><p>在 package.json 根节点加上 <code>&quot;type&quot;: &quot;moudle&quot;</code></p></li> <li><p>export default 默认导出成员（只允许一次）</p> <p>import 接收名称 from '模块名称'</p></li> <li><p>按需导出：export 成员（可多次导出）</p> <p>按需导入：import {s1,s2} from '模块名称'（可通过 as 取别名，info 指向默认导出的成员，如<code>import info,{s1 as pkq,s2} from '模块名称'</code>）</p></li> <li><p>直接运行模块代码：import '模块名称'</p></li></ol> <h3 id="_3-promise"><a href="#_3-promise" class="header-anchor">#</a> (3) Promise</h3> <p>回调地狱：多层回调函数嵌套，难以维护、可读性差。</p> <ul><li><p>Promise 是一个构造函数（<code>const p = new Promise()</code>，代表一个异步操作）</p></li> <li><p>Promise.prototype 上包含一个.then()方法（每个实例可通过原型链的方式访问.then()方法）</p></li> <li><p>.then()方法用来预先指定成功和失败的回调函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 两个参数：成功回调函数（必选），失败回调函数（可选）</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div></li></ul> <ol><li><p>基于回调函数按顺序读取文件内容</p> <ul><li><p>npm i then-fs</p></li> <li><p>异步读取（无法保证顺序）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> thenFs <span class="token keyword">from</span> <span class="token string">'then-fs'</span>

thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/1.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/2.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/3.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r3<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>Promise 链式调用：</p> <div class="language-js extra-class"><pre class="language-js"><code>thenFs
  <span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/1.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span>
    <span class="token keyword">return</span> thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/2.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/3.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r3</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r3<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>通过 .catch() 捕获错误。</p></li></ul></li> <li><p>Promise.all()：所有异步操作全部结束后执行.then()</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> thenFs <span class="token keyword">from</span> <span class="token string">'then-fs'</span>

<span class="token keyword">let</span> promiseArr <span class="token operator">=</span> <span class="token punctuation">[</span>
  thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/1.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/2.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/3.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promiseArr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> r3<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> r3<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 111 222 333</span>
</code></pre></div></li> <li><p>Promise.race()：赛跑机制，读取速度最快的结果。</p></li> <li><p>基于 Promise 封装读文件的方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">'fs'</span>
<span class="token keyword">function</span> <span class="token function">getFile</span><span class="token punctuation">(</span><span class="token parameter">fpath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>fpath<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">getFile</span><span class="token punctuation">(</span><span class="token string">'./files/1.txt'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="_4-async-awit"><a href="#_4-async-awit" class="header-anchor">#</a> (4) async / awit</h3> <p>这是 ES8 用来简化 Promise 异步操作的。</p> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>如果函数使用了 await ，则函数必须被 async 修饰</p> <p>在 async 函数中，第一个 await 之前的代码会被同步执行，后面的异步执行</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> thenFs <span class="token keyword">from</span> <span class="token string">'then-fs'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> r1 <span class="token operator">=</span> <span class="token keyword">await</span> thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/1.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span>
  <span class="token keyword">const</span> r2 <span class="token operator">=</span> <span class="token keyword">await</span> thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/2.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span>
  <span class="token keyword">const</span> r3 <span class="token operator">=</span> <span class="token keyword">await</span> thenFs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./files/3.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r3<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'D'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span>

<span class="token comment">// A</span>
<span class="token comment">// C</span>
<span class="token comment">// B</span>
<span class="token comment">// 111</span>
<span class="token comment">// 222</span>
<span class="token comment">// 333</span>
<span class="token comment">// D</span>
</code></pre></div><h3 id="_5-执行顺序"><a href="#_5-执行顺序" class="header-anchor">#</a> (5) 执行顺序</h3> <ol><li><p>EventLoop</p> <ul><li><p>同步任务（非耗时任务）</p></li> <li><p>异步任务（耗时任务）：由宿主环境进行执行，执行完会通知 JS 主线程执行异步回调函数。</p></li></ul> <img src="/blog_img/vue3_01.png"></li> <li><p>宏任务、微任务</p> <img src="/blog_img/vue3_02.png"> <p>宏任务与微任务的执行顺序：</p> <p>每个宏任务执行完，检查是否存在待执行的微任务，若有则执行完微任务，然后执行下一个宏任务。</p></li> <li><p>经典面试题</p> <ul><li>题 1</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">)</span>

<span class="token comment">// 同步任务2、4；微任务3；宏任务1</span>
<span class="token comment">// 输出：2431</span>
</code></pre></div><ul><li>题 2</li></ul> <img src="/blog_img/vue3_03.png"></li></ol> <h3 id="_6-api-接口"><a href="#_6-api-接口" class="header-anchor">#</a> (6) API 接口</h3> <ol><li><p>初始化项目，创建基本服务器</p></li> <li><p>配置 MySQL 模块（npm i mysql2@2.2.5）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> mysql <span class="token keyword">from</span> <span class="token string">'mysql2'</span>

<span class="token keyword">const</span> pool <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
  <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">'my_db_01'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> pool<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>创建 user_handler 模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> db <span class="token keyword">from</span> <span class="token string">'../db/index.js'</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>rows<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'select * from   ev_article_cate'</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'获取数据成功！'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> rows<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'获取数据失败！'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">desc</span><span class="token operator">:</span> e<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>创建 user_router 模块，并挂载</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">'express'</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">express<span class="token punctuation">.</span>Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> getData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../router-handler/user.js'</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/userinfo'</span><span class="token punctuation">,</span> getData<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div></li></ol> <h2 id="二、vue3-基础入门"><a href="#二、vue3-基础入门" class="header-anchor">#</a> 二、Vue3 基础入门</h2> <p><a href="https://v2.cn.vuejs.org/" target="_blank" rel="noopener noreferrer">官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_1-引入"><a href="#_1-引入" class="header-anchor">#</a> (1) 引入</h3> <ol><li><p>vue 全家桶：vue(核心库)、vue-router(路由方案)、vuex(状态管理方案)、vue 组件库(快速搭建页面)</p></li> <li><p>工具包</p> <ul><li><p>vue-cli(npm 全局包：一键生成工程化的 vue 项目-基于 webpack、大而全)</p></li> <li><p>vite(npm 全局包：一键生成工程化的 vue 项目-小而巧)</p></li> <li><p>vue-devtools(浏览器插件：辅助调试的工具)</p></li> <li><p>vetur(vscode 插件：提供语法高亮和智能提示)</p></li></ul></li> <li><p>与 2.x 的区别：</p> <p>新增功能：组合式 API、多根节点组件、更好的 TypeScript 支持</p> <p>废弃功能：过滤器、不再支持 $on、$off 和 $once 实例方法</p></li></ol> <h3 id="_2-vite"><a href="#_2-vite" class="header-anchor">#</a> (2) vite</h3> <table><thead><tr><th></th> <th>vite</th> <th>vue-cli</th></tr></thead> <tbody><tr><td>支持的 vue 版本</td> <td>仅支持 vue3.x</td> <td>支持 3.x 和 2.x0</td></tr> <tr><td>是否基于 webpack</td> <td>否</td> <td>是</td></tr> <tr><td>运行速度</td> <td>快</td> <td>慢</td></tr> <tr><td>功能完整度</td> <td>小而巧（逐渐完善）</td> <td>大而全</td></tr> <tr><td>是否建议在企业级开发</td> <td>建议</td> <td>建议</td></tr></tbody></table> <ol><li><p>创建 vite 项目：</p> <ul><li><p>npm init vite-app 项目名称</p></li> <li><p>cd 项目名称</p></li> <li><p>npm i</p></li> <li><p>npm run dev</p></li></ul></li> <li><p>项目结构：</p> <ul><li><p>node_modules 目录用来存放第三方依赖包</p></li> <li><p>public 是公共的静态资源目录</p></li> <li><p>gitignore 是 Git 的忽略文件</p></li> <li><p>index.html 是 SPA 单页面应用程序中唯一的 HTML 页面</p></li> <li><p>package.json 是项目的包管理配置文件</p></li> <li><p>src 是项目的源代码目录（程序员写的所有代码都要放在此目录下）</p> <ul><li><p>assets 目录用来存放项目中所有的静态资源文件(css、fonts 等)</p></li> <li><p>components 目录用来存放项目中所有的自定义组件</p></li> <li><p>App.vue 是项目的根组件</p></li> <li><p>index.css 是项目的全局样式表文件</p></li> <li><p>main.js 是整个项目的打包入口文件</p></li></ul></li></ul></li> <li><p>渲染：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="_3-与-vue2-的不同点"><a href="#_3-与-vue2-的不同点" class="header-anchor">#</a> (3) 与 vue2 的不同点</h3> <ol><li><p>注意点：</p> <ul><li><p>在 vue3 中 template 可有多个根节点；</p></li> <li><p>注意此时路径中的@不代表根目录；</p></li> <li><p>样式穿透建议：<code>:deep(.title)</code>；</p></li> <li><p>自定义事件：需要声明 emits: ['countChange']</p></li> <li><p>全局注册组件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Swiper <span class="token keyword">from</span> <span class="token string">'./components/swiper'</span>

<span class="token comment">// app.component('my-swiper', Swiper)</span>
app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Swiper<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Swiper<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>:style 可动态绑定 css 样式的值（驼峰命名，短横线需单引号包裹）</p></li> <li><p>动态绑定 class：三元表达式，可用 数组+三元表达式 合用</p></li> <li><p><code>:class=&quot;classObj&quot;</code> （属性为类名）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">classObj</span><span class="token operator">:</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">active</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
 <span class="token literal-property property">italic</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>props 自定义验证函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">flag</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token comment">// 必须匹配到下面字符串的其中一个</span>
   <span class="token function">validator</span><span class="token punctuation">(</span><span class="token parameter">vl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token string">'warning'</span><span class="token punctuation">,</span> <span class="token string">'danger'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>vl<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>组件的生命周期</p> <img src="/blog_img/vue3_04.png"></li></ol> <h3 id="_4-组件通信"><a href="#_4-组件通信" class="header-anchor">#</a> (4) 组件通信</h3> <ol><li><p>父传子：自定义属性</p></li> <li><p>子传父：自定义事件</p></li> <li><p>父子数据同步：v-model</p> <img src="/blog_img/vue3_05.png"></li> <li><p>兄弟之间共享：EventBus，使用第三方包 mitt 。</p> <img src="/blog_img/vue3_06.png"></li> <li><p>父与子孙数据共享：</p> <ul><li>非响应式(父发生变化时，子孙不变)：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span>
 <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span><span class="token punctuation">{</span>
     <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token string">'red'</span> <span class="token comment">// 1.定义&quot;父组件&quot; 要向 &quot;子孙组件&quot; 共享的数据</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 2.provide函数return的对象中，包含了&quot;要向子孙组件共享的  数据&quot;</span>
 <span class="token keyword">return</span><span class="token punctuation">{</span>
   <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>color
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子孙组件用：inject 节点接收。</span>
</code></pre></div><ul><li>响应式：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span> <span class="token comment">// 1.从ue中按需导入 computed 函数</span>

<span class="token keyword">export</span> <span class="token keyword">default</span>
 <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span><span class="token punctuation">{</span>
     <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token string">'red'</span> <span class="token comment">// 1.定义&quot;父组件&quot; 要向 &quot;子孙组件&quot; 共享的数据</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 2.provide函数return的对象中，包含了&quot;要向子孙组件共享的  数据&quot;</span>
 <span class="token keyword">return</span><span class="token punctuation">{</span>
   <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子孙组件用：inject 节点接收。</span>
</code></pre></div></li> <li><p>vuex 介绍（<a href="/blogs/frontend/vue2.html#_2-vuex">传送门</a>）：终极的组件之间数据共享方案，高效、清晰、易于维护。</p></li></ol> <h3 id="_5-axios-与-自定义指令"><a href="#_5-axios-与-自定义指令" class="header-anchor">#</a> (5) axios 与 自定义指令</h3> <ol><li><p>axios 的挂载</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在main.js</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">''</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$http <span class="token operator">=</span> axios
</code></pre></div></li> <li><p>自定义指令</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 私有自定义指令</span>
<span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">xxx</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">//只在DOM创建时第一次更新</span>
            el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span>
        <span class="token function">updated</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">//只在DOM创建时第一次更新</span>
            el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 全局自定义指令</span>
app<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>binding</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h2 id="三、路由"><a href="#三、路由" class="header-anchor">#</a> 三、路由</h2> <ol><li><p>路由版本为：</p> <ul><li>vue2：vue-router3.x（<a href="https://router.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">网址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li> <li>vue3：vue-router4.x（<a href="https://v3.router.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">网址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li></ul> <p>npm i vue-router@4.0.3 -S</p></li> <li><p>配置 vue-router：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 指定路由工作模式</span>
    <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div></li> <li><p>在 main.js 挂载路由</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">''</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>路由高亮：清晰看到路由是否激活</p> <ul><li><p>默认高亮 class 类：router-link-active</p></li> <li><p>自定义路由高亮 class 类：在配置 vue-router 时，创建 router 实例时加入<code>linkActiveClass: '自定义名称'</code></p></li></ul></li> <li><p>命名路由：路由规则中自定义名称（<code>name: ''</code>），必须唯一。</p> <div class="language-html extra-class"><pre class="language-html"><code>// 可通过 params 携带路由参数
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{name: 'home',params: {id: 3}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>实现编程式导航：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h2 id="四、vue3-加强"><a href="#四、vue3-加强" class="header-anchor">#</a> 四、Vue3 加强</h2> <h3 id="_1-vue-cli"><a href="#_1-vue-cli" class="header-anchor">#</a> (1) vue-cli</h3> <ol><li><p>解决 PowerShell 不识别 vue 命令：</p> <ul><li><p>以管理员身份运行 PowerShell</p></li> <li><p>执行 set-ExecutionPolicy RemoteSigned 命令</p></li> <li><p>输入字符 Y，回车即可</p></li></ul></li> <li><p>创建项目：vue create xxx ； vue ui （可视化面板）</p></li></ol> <h3 id="_2-组件库"><a href="#_2-组件库" class="header-anchor">#</a> (2) 组件库</h3> <p>bootstrap 是纯粹的原材料；组件库是遵循 vue 语法、高度定制的组件。</p> <p>PC 端：<a href="https://element.eleme.cn/#/zh-CN" target="_blank" rel="noopener noreferrer">Element UI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://v1.iviewui.com/" target="_blank" rel="noopener noreferrer">View UI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>移动端：<a href="http://mint-ui.github.io/#!/zh-cn" target="_blank" rel="noopener noreferrer">Mint UI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://vant-contrib.gitee.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer">Vant<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Element UI 的使用：</p> <ul><li><p>安装：npm i element-ui -S</p></li> <li><p>完整引入：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>按需引入：</p> <p>安装：npm install babel-plugin-component -D</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">//  .babelrc</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;component&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;libraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;styleLibraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;theme-chalk&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button<span class="token punctuation">,</span> Select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-ui'</span>

Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Button<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Button<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Select<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Select<span class="token punctuation">)</span>
</code></pre></div><p>组件的导入注册封装为独立的模块：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// → 模块路径/src/element-ui/index.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// 按需导入element ui的组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button<span class="token punctuation">,</span> Input <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token comment">// 注册需要的组件</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Input<span class="token punctuation">)</span>

<span class="token comment">// → 在main.js中导入</span>
<span class="token keyword">import</span> <span class="token string">'./element-ui'</span>
</code></pre></div></li></ul> <h3 id="_3-axios-拦截器"><a href="#_3-axios-拦截器" class="header-anchor">#</a> (3) axios 拦截器</h3> <img src="/blog_img/vue3_07.png"> <ol><li><p>配置请求拦截器</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 成功回调函数</span>
    <span class="token keyword">return</span> config
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 失败回调函数（可省略）</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><ul><li>token 认证</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token string">'https://ww.escook.cn'</span>
<span class="token comment">//配置请求的拦裁器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token comment">//为当前请求配置Token认证字段</span>
  config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token string">'Bearer xxx'</span>
  <span class="token keyword">return</span> config
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$http <span class="token operator">=</span> axios
</code></pre></div><ul><li>实现 Loding 效果</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.按需导入Loading效果组件</span>
<span class="token keyword">import</span> Loading <span class="token keyword">from</span> <span class="token string">'element-ui'</span>

<span class="token comment">// 2.声明变量，用来存储Loading组件的实例对象</span>
<span class="token keyword">let</span> loadingInstance <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token comment">// 配置请求的拦藏器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//3.调用Loading组件的service()方法，创建Loading组件的实例，并全屏展示loading效果</span>
  loadingInstance <span class="token operator">=</span> Loading<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">fullscreen</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> config
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>配置响应拦截器</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 成功回调函数</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 失败回调函数（可省略）</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><ul><li>关闭 Loding 效果</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//响应拦载器</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//调用Loading实例的close方法即可关闭loading效果</span>
  loadingInstance<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> response
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="_4-proxy-跨域代理"><a href="#_4-proxy-跨域代理" class="header-anchor">#</a> (4) proxy 跨域代理</h3> <p>后端没有开启 CORS</p> <img src="/blog_img/vue3_08.png"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">'http://localhost:8080'</span>

<span class="token comment">// vue.config.js</span>
moudle<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token string">'https://www.escook.cn'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">DANGER</p> <ul><li><p>proxy 跨域代理只支持在开发阶段。</p></li> <li><p>项目上线发布时，依旧需要 API 接口开启 CORS 跨域资源共享或者使用 Nginx 反向代理。</p></li></ul></div> <h2 id="五、补充"><a href="#五、补充" class="header-anchor">#</a> 五、补充</h2> <h3 id="_1-打包配置"><a href="#_1-打包配置" class="header-anchor">#</a> (1) 打包配置</h3> <ol><li><p>Vue（vue-cli）打包：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在 vue.config.js 中配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>vite 打包：</p> <ul><li><p>将 vite 版本改为 3.0.0</p></li> <li><p>安装 @vitejs/plugin-vue</p></li> <li><p>在 vite.config.js 中配置</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>
<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token comment">// 添加这个属性</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>需要在服务器中打开，在 Live Server 也可打开。</p></li></ol> <h3 id="_2-其他"><a href="#_2-其他" class="header-anchor">#</a> (2) 其他</h3> <ol><li><p>将第三方包变为全局可用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在main.js</span>
<span class="token keyword">import</span> dayjs <span class="token keyword">from</span> <span class="token string">'dayjs'</span>
<span class="token comment">// 把 dayjs 挂载到Vue原型上</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$dayjs <span class="token operator">=</span> dayjs
</code></pre></div></li> <li><p>关于父组件异步请求，子组件渲染出问题：<a href="https://www.cnblogs.com/liujingjing/p/10737285.html" target="_blank" rel="noopener noreferrer">传送门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blogs/frontend/vue2.html" class="prev">
        Vue2
      </a></span> <span class="next"><a href="/blogs/frontend/react.html">
        React
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 陈扬伟的博客
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="http://music.163.com/song/media/outer/url?id=2049512697.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="right:10px;bottom:275px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="http://p1.music.126.net/TmOHxaGnFNlwNX8aPz66oA==/109951168638913915.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="right:10px;bottom:275px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(http://p1.music.126.net/TmOHxaGnFNlwNX8aPz66oA==/109951168638913915.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>向云端</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>小霞</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><div></div></div></div>
    <script src="/assets/js/app.e7a0482f.js" defer></script><script src="/assets/js/2.e098fada.js" defer></script><script src="/assets/js/21.dcf8b3f5.js" defer></script>
  </body>
</html>
